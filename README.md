Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"  

1. Проверить доступные интерфейсы можно с помощью команд:  
   ```bash
   ifconfig -a
   ip link
   netstat -i
   nmcli device status
   ```  
  
2. Используется протокол **LLDP**. Для него в Linux есть пакет **lldpd**, включающий в себя демона **lldpd** и команды для управления **lldpcli** и **lldpctl**, которые запускают интерактивную оболочку, используемую для ввода различных команд. Например `show neighbors` отобразит информацию обо всех соседях, известных демону **lldpd**, `show interfaces` отобразит информацию о локальных интерфейсах, команда `watch` позволяет отслеживать и сообщать обо всех изменениях в указанном соседе. Полный список команд можно посмотреть в `man lldpcli` и `man lldpctl`.  

3. Для разделения на коммутатора на виртуальные сети используется **VLAN**. В Linux создать устройства VLAN можно несколькими способами:  
   - Командой `ip`  
      ```
      ip link add link eth0 name eth0.100 type vlan id 100
      ip -d link show eth0.100
      ip addr add 192.168.1.100/24 brd 192.168.1.255 dev eth0.100
      ip link set dev eth0.100 up
      ```  
   - С помощью команд `vconfig` и `ifconfig`  
      ```
      vconfig add eth0 100
      ifconfig eth0.100 192.168.1.100 netmask 255.255.255.0 broadcast 192.168.1.255 up
      ```  
   - Прописав конфигурацию в */etc/network/interfaces*  
      ```
      auto eth0.100
      iface eth0.100 inet static
      address 192.168.1.100
      netmask 255.255.255.0
      vlan-raw-device eth0
      ```  

4. Для агрегации интерфейсов в Linux используется пакет **ifenslave** и входящий в него модуль **bonding**.  Для балансировки нагрузки доступны следующие опции:  
      - `mode=0` (round robin) - циклически использует физические интерфейсы для передачи пакетов. Этот режим обеспечивает балансировку нагрузки и отказоустойчивость.  
      - `mode=1` (active-backup) - используется только 1 интерфейс, а остальные являются резервными. Если первый интерфейс отказывает, его работу берет на себя следующий и он становится активным. Не требует дополнительной настройки коммутатора. Этот режим обеспечивает отказоуствойчивость.  
      - `mode=2` (balance-xor) - XOR политика. Выбирает для каждого получателя определенный интерфейс в соответсвии с mac-адресом. Этот режим обеспечивает балансировку нагрузки и отказоустойчивость.  
      - `mode=3` (broadcast) - все пакеты передаются на все интерфейсч. Режим обеспечивает отказоустойчивость.  
      - `mode=4` (802.3ad) - IEEE 802.3ad Dynamic Link aggregation (динамическое объединение каналов). Создает агрегации групп, имеющие одни и те же скорости и дуплексные настройки. Использует все включенные интерфейсы в активном агрегаторе согласно спецификации 802.3ad.  
      - `mode=5` (balance-tlb) - адаптивная балансировка передаваемой нагрузки, исходящий трафик распределяется в соответствии с текущей нагрузкой (вычисляется по скоростям) для каждого интерфейса. Входящий трафик принимается текущим интерфейсом. Если принимающий интерфейс выходит из строя, то следующий занимает его место приватизировав его mac-адрес.  
      - `mode=6` (balance-alb) - адаптивное перераспределение нагрузки, включает balance-tlb плюс receive load balancing (rlb) для трафика IPv4 и не требует специального конфигурирования. То есть все так же как и при mode=5, только и входящий трафик балансируется между интерфейсами. Полученная балансировка нагрузки достигается опросом ARP. Драйвер перехватывает ответы ARP, направленные в локальной системе в поисках выхода и перезаписывает исходный адрес сетевой карты с уникальным аппаратным адресом одного из интерфейсов в группе.  
   Пример конфигурации */etc/network/interfaces*  
      ```
      auto eth0
      iface eth0 inet manual
          bond-master bond0
          
      auto eth1
      iface eth1 inet manual
          bond-master bond0

      auto bond0
      iface bond0 inet static
          address 192.168.1.100
          gateway 192.168.1.1
          netmask 255.255.255.0
          bond-mode 1
          bond-miimon 100
          bond-slaves eth0 eth1
      ```   

5. В сети с маской /29 всего 8 адресов, из которых 2 зарезервированы, в остатке 6 узловых адресов. Из сети с маской /24 можно получить 32 сети с маской /29. Примеры: 10.10.10.0/29, 10.10.10.8/29, 10.10.10.16/29, 10.10.10.24/29 и т.д.  

6. Допустимо взять частные IP адреса из подсети 100.64.0.0. Из расчета 40-50 хостов будем использовать маску /26 (всего 64 адреса, с учетом 2х зарезервированных).  

7. Для проверки ARP таблицы используется одноименная команда `arp`. Без дополнительных ключей будет выведено текущее содержимое таблицы (`-a` в формате BSD, по умолчанию `-e` в формате Linux).  
   Для полной очистки кэша ARP можно воспользоваться командой **ip**: `ip -s -s neigh flush all`  
   Для удаления отдельного IP адреса из таблицы применяется ключ `-d` для команды `arp` и дальше указывается адрес, который необходимо удалить. Если вместо IP адреса указать имя хоста, то перед поиском IP адреса в таблице сперва будет зарезолвен этот хост.  